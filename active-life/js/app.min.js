function initReveal(){document.documentElement.classList.add("js");const e=document.querySelectorAll("[data-reveal]");if(!e.length)return;if(window.matchMedia("(prefers-reduced-motion: reduce)").matches||!("IntersectionObserver"in window))return void e.forEach(e=>{e.classList.add("is-revealed"),e.dataset.revealReady="true"});const t=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("is-revealed"),e.target.dataset.revealReady="true",t.unobserve(e.target))})},{threshold:.2});e.forEach(e=>{"true"!==e.dataset.revealReady&&(t.observe(e),e.dataset.revealReady="true")})}function initHeaderShrink(){const e=document.querySelector("[data-header]");if(!e)return;const t=()=>{window.scrollY>12?e.classList.add("header--scrolled"):e.classList.remove("header--scrolled")};t(),window.addEventListener("scroll",t,{passive:!0})}const focusableSelectors=["a[href]","button:not([disabled])","textarea:not([disabled])","input:not([disabled])","select:not([disabled])","[tabindex]:not([tabindex='-1'])"];function initMobileNav(){const e=document.querySelector("[data-nav-toggle]"),t=document.querySelector("[data-mobile-nav]"),n=document.querySelector("[data-nav-close]"),r=window.matchMedia("(min-width: 700px)");if(!e||!t||!n)return;let a=null;const i=({restoreFocus:n=!0}={})=>{t.inert=!0,t.hidden=!0,e.setAttribute("aria-expanded","false"),document.body.style.overflow="",n&&a&&a.focus()},o=()=>{r.matches?i({restoreFocus:!1}):t.inert=t.hidden};e.addEventListener("click",()=>{t.hidden?(()=>{a=document.activeElement,t.inert=!1,t.hidden=!1,e.setAttribute("aria-expanded","true"),document.body.style.overflow="hidden";const n=t.querySelectorAll(focusableSelectors.join(","));n.length&&n[0].focus()})():i()}),n.addEventListener("click",i),t.addEventListener("click",e=>{e.target===t&&i()}),document.addEventListener("keydown",e=>{if(t.hidden)return;if("Escape"===e.key)return void i();if("Tab"!==e.key)return;const n=t.querySelectorAll(focusableSelectors.join(","));if(!n.length)return;const r=n[0],a=n[n.length-1];e.shiftKey&&document.activeElement===r?(e.preventDefault(),a.focus()):e.shiftKey||document.activeElement!==a||(e.preventDefault(),r.focus())}),t.querySelectorAll("a[href]").forEach(e=>{e.addEventListener("click",i)}),r.addEventListener("change",o),o()}function initScheduleFilter(){const e=document.querySelectorAll("[data-filter]"),t=document.querySelectorAll(".schedule-card");if(!e.length||!t.length)return;e.forEach(n=>{n.addEventListener("click",()=>{const r=n.dataset.filter;(t=>{e.forEach(e=>e.classList.remove("is-active")),t.classList.add("is-active")})(n),(e=>{t.forEach(t=>{const n=t.dataset.category,r="all"===e||e===n;t.style.display=r?"flex":"none"})})(r)})})}const STORAGE_KEY="activelife-theme";function initThemeToggle(){const e=document.querySelector("[data-theme-toggle]");if(!e)return;const t=window.matchMedia("(prefers-color-scheme: dark)").matches;function n(t){document.documentElement.setAttribute("data-theme",t),e.setAttribute("aria-pressed","dark"===t?"true":"false")}n(localStorage.getItem(STORAGE_KEY)||(t?"dark":"light")),e.addEventListener("click",()=>{const e="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";n(e),localStorage.setItem(STORAGE_KEY,e)})}document.documentElement.classList.add("js"),initReveal(),initHeaderShrink(),initMobileNav(),initScheduleFilter(),initThemeToggle();const sections=document.querySelectorAll("main section[id]"),navLinks=document.querySelectorAll(".nav__link");if(sections.length&&navLinks.length){const e=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target.getAttribute("id");navLinks.forEach(e=>{e.classList.toggle("is-active",e.getAttribute("href")===`#${t}`)})}})},{threshold:.6});sections.forEach(t=>e.observe(t))}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js")});